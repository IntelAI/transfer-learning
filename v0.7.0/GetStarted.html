<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Get Started &mdash; Intel® Transfer Learning Tool 0.2.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/tlt-custom.css" type="text/css" />
    <link rel="shortcut icon" href="_static/favicon-intel-32x32.png"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/documentation_options.js?v=938c9ccc"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/tlt-custom.js?v=c75969d3"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Examples" href="examples/examples.html" />
    <link rel="prev" title="Intel® Transfer Learning Tool" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Intel® Transfer Learning Tool
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Documentation Home</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Get Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#check-system-requirements">① Check System Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#install">② Install</a></li>
<li class="toctree-l2"><a class="reference internal" href="#run-the-intel-transfer-learning-tool">③ Run the Intel Transfer Learning Tool</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#a-run-using-the-no-code-cli">a) Run Using the No-Code CLI</a></li>
<li class="toctree-l3"><a class="reference internal" href="#b-run-using-the-low-code-api">b) Run Using the Low-Code API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#summary-and-next-steps">Summary and Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples/examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">CLI Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="Models.html">Supported Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="Legal.html">Legal Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="genindex.html">Index</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/IntelAI/transfer-learning-tool">GitHub Repository</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Intel® Transfer Learning Tool</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Get Started</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/GetStarted.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="get-started">
<h1>Get Started<a class="headerlink" href="#get-started" title="Link to this heading">¶</a></h1>
<p>This is a guide for getting started with Intel® Transfer Learning Tool and will
walk you through the steps to check system requirements, install, and then run
the tool with a couple of examples showing no-code CLI and low-code API
approaches.</p>
<p align="center"><b>Intel Transfer Learning Tool Get Started Flow</b></p>
<a class="reference internal image-reference" href="_images/TLT-GSG_flow.svg"><img alt="Intel Transfer Learning Tool Get Started Flow" src="_images/TLT-GSG_flow.svg" width="800" /></a>
<section id="check-system-requirements">
<h2>① Check System Requirements<a class="headerlink" href="#check-system-requirements" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Recommended Hardware</p></th>
<th class="head"><p>Precision</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Intel® 4th Gen Xeon® Scalable Performance processors</p></td>
<td><p>BF16</p></td>
</tr>
<tr class="row-odd"><td><p>Intel® 1st, 2nd, 3rd, and 4th Gen Xeon® Scalable Performance processors</p></td>
<td><p>FP32</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Resource</p></th>
<th class="head"><p>Minimum</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CPU Cores</p></td>
<td><p>8  (16+ recommended)</p></td>
</tr>
<tr class="row-odd"><td><p>RAM</p></td>
<td><p>16 GB (24-32+ GB recommended)</p></td>
</tr>
<tr class="row-even"><td><p>Disk space</p></td>
<td><p>10 GB minimum (can vary based on datasets downloaded)</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Required Software</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Linux* system (validated on Ubuntu* 20.04/22.04 LTS)</p></td>
</tr>
<tr class="row-odd"><td><p>Python (3.8, 3.9, or 3.10)</p></td>
</tr>
<tr class="row-even"><td><p>Pip</p></td>
</tr>
<tr class="row-odd"><td><p>Conda or Python virtualenv</p></td>
</tr>
<tr class="row-even"><td><p>git (only required for advanced installation)</p></td>
</tr>
</tbody>
</table>
</section>
<section id="install">
<h2>② Install<a class="headerlink" href="#install" title="Link to this heading">¶</a></h2>
<ol class="arabic">
<li><p><strong>Install Dependencies</strong></p>
<p>Install required packages using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">build</span><span class="o">-</span><span class="n">essential</span> <span class="n">python3</span><span class="o">-</span><span class="n">dev</span> <span class="n">libgl1</span> <span class="n">libglib2</span><span class="mf">.0</span><span class="o">-</span><span class="mi">0</span>
</pre></div>
</div>
</li>
<li><p><strong>Create and activate a Python3 virtual environment</strong></p>
<p>We encourage you to use a Python virtual environment (virtualenv or conda)
for consistent package management.  There are two ways to do this:</p>
<p>a. Use <code class="docutils literal notranslate"><span class="pre">virtualenv</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">virtualenv</span> <span class="o">-</span><span class="n">p</span> <span class="n">python3</span> <span class="n">tlt_dev_venv</span>
<span class="n">source</span> <span class="n">tlt_dev_venv</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">activate</span>
</pre></div>
</div>
<p>b. Or use <code class="docutils literal notranslate"><span class="pre">conda</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">create</span> <span class="o">--</span><span class="n">name</span> <span class="n">tlt_dev_venv</span> <span class="n">python</span><span class="o">=</span><span class="mf">3.9</span>
<span class="n">conda</span> <span class="n">activate</span> <span class="n">tlt_dev_venv</span>
</pre></div>
</div>
</li>
<li><p><strong>Install Intel Transfer Learning Tool</strong></p>
<p>Use the Basic Installation instructions unless you plan on making code changes or installing the latest code from the repository.
Please note that mixing basic and advanced installation options within the same virtual environment is not supported.</p>
<p>a. <strong>Basic Installation</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">intel</span><span class="o">-</span><span class="n">transfer</span><span class="o">-</span><span class="n">learning</span><span class="o">-</span><span class="n">tool</span>
</pre></div>
</div>
<p>b. <strong>Advanced Installation</strong></p>
<p>Clone the repo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">IntelAI</span><span class="o">/</span><span class="n">transfer</span><span class="o">-</span><span class="n">learning</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">transfer</span><span class="o">-</span><span class="n">learning</span>
</pre></div>
</div>
<p>Then either do an editable install to avoid a rebuild and
install after each code change (preferred):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">.</span>
</pre></div>
</div>
<p>or build and install a wheel:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">bdist_wheel</span>
<span class="n">pip</span> <span class="n">install</span> <span class="n">dist</span><span class="o">/</span><span class="n">intel_transfer_learning_tool</span><span class="o">-</span><span class="mf">0.7.0</span><span class="o">-</span><span class="n">py3</span><span class="o">-</span><span class="n">none</span><span class="o">-</span><span class="nb">any</span><span class="o">.</span><span class="n">whl</span>
</pre></div>
</div>
</li>
<li><p><strong>Additional Feature-Specific Steps</strong></p>
<ul class="simple">
<li><p>For distributed/multinode training, follow these additional
<a class="reference internal" href="#tlt/distributed/README.md"><span class="xref myst">distributed training instructions</span></a>.</p></li>
</ul>
</li>
<li><p><strong>Verify Installation</strong></p>
<p>Verify that your installation was successful by using the following
command, which displays help information about the Intel Transfer Learning Tool:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tlt</span> <span class="o">--</span><span class="n">help</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="run-the-intel-transfer-learning-tool">
<h2>③ Run the Intel Transfer Learning Tool<a class="headerlink" href="#run-the-intel-transfer-learning-tool" title="Link to this heading">¶</a></h2>
<p>With the Intel Transfer Learning Tool, you can train AI models with TensorFlow or
PyTorch using either no-code CLI commands at a bash prompt, or low-code API
calls from a Python script. Both approaches provide the same opportunities for
training, evaluation, optimization, and benchmarking. With the CLI, no
programming experience is required, and you’ll need basic Python knowledge to
use the API. Choose the approach that works best for you.</p>
<section id="a-run-using-the-no-code-cli">
<h3>a) Run Using the No-Code CLI<a class="headerlink" href="#a-run-using-the-no-code-cli" title="Link to this heading">¶</a></h3>
<p>Let’s continue from the previous step where you prepared the dataset, and train
a model using CLI commands.  This example uses the CLI to train an image
classifier to identify different types of flowers. You can see a list of all
available image classifier models using the command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tlt</span> <span class="nb">list</span> <span class="n">models</span> <span class="o">--</span><span class="n">use</span><span class="o">-</span><span class="n">case</span> <span class="n">image_classification</span>
</pre></div>
</div>
<p><strong>Train a Model</strong></p>
<p>In this example, we’ll use the <code class="docutils literal notranslate"><span class="pre">tlt</span> <span class="pre">train</span></code> command to retrain the PyTorch
efficientnet_b0 model using a food101 dataset from the
<a class="reference external" href="https://pytorch.org/vision/stable/generated/torchvision.datasets.Food101.html">PyTorch Datasets</a>.
The <code class="docutils literal notranslate"><span class="pre">--dataset-dir</span></code> and <code class="docutils literal notranslate"><span class="pre">--output-dir</span></code> paths need to point to writable folders on your system.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="n">tlt</span> <span class="n">train</span> <span class="o">-</span><span class="n">f</span> <span class="n">pytorch</span> <span class="o">--</span><span class="n">model</span><span class="o">-</span><span class="n">name</span> <span class="n">efficientnet_b0</span> <span class="o">--</span><span class="n">dataset</span><span class="o">-</span><span class="n">name</span> <span class="n">Food101</span> <span class="o">--</span><span class="n">dataset</span><span class="o">-</span><span class="nb">dir</span> <span class="s2">&quot;/tmp/data-$</span><span class="si">{USER}</span><span class="s2">&quot;</span> <span class="o">--</span><span class="n">output</span><span class="o">-</span><span class="nb">dir</span> <span class="s2">&quot;/tmp/output-$</span><span class="si">{USER}</span><span class="s2">&quot;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Model name: efficientnet_b0
Framework: pytorch
Dataset name: Food101
Training epochs: 1
Dataset dir: /tmp/data-user
Output directory: /tmp/output-user

...
Epoch 1/1
----------
100%|██████████████████████████████████████████████████| 1776/1776 [27:02&lt;00:00,  1.09it/s]
Performing Evaluation
100%|██████████████████████████████████████████████████| 592/592 [08:33&lt;00:00,  1.15it/s]
Loss: 2.7038 - Acc: 0.3854 - Val Loss: 2.1242 - Val Acc: 0.4880
Training complete in 35m 37s
Saved model directory: /tmp/output-user/efficientnet_b0/1
</pre></div>
</div>
<p>After training completes, the <code class="docutils literal notranslate"><span class="pre">tlt</span> <span class="pre">train</span></code> command evaluates the model. The loss and
accuracy values are printed toward the end of the console output. The model is
exported to the output directory you specified in a numbered folder created for
each training run.</p>
<p><strong>Next Steps</strong></p>
<p>That ends this Get Started CLI example. As a next step, you can also follow the
<a class="reference internal" href="#examples/cli/README.md"><span class="xref myst">Beyond Get Started CLI Example</span></a> for a complete example
that includes evaluation, benchmarking, and quantization in the datasets.</p>
<p>Read about all the CLI commands in the <a class="reference internal" href="#/cli.md"><span class="xref myst">CLI reference</span></a>.
Find more examples in our list of <a class="reference internal" href="#examples/README.md"><span class="xref myst">Examples</span></a>.</p>
</section>
<section id="b-run-using-the-low-code-api">
<h3>b) Run Using the Low-Code API<a class="headerlink" href="#b-run-using-the-low-code-api" title="Link to this heading">¶</a></h3>
<p>The following Python code example trains an image classification model with the PyTorch
RenderedSST2 dataset using API calls from Python.  The model is
benchmarked and quantized to INT8 precision for improved inference performance.</p>
<p>You can run the API example using a Jupyter notebook. See the <a class="reference internal" href="#/notebooks/setup.md"><span class="xref myst">notebook setup
instructions</span></a> for more details for preparing the Jupyter
notebook environment.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">tlt.datasets</span> <span class="kn">import</span> <span class="n">dataset_factory</span>
<span class="kn">from</span> <span class="nn">tlt.models</span> <span class="kn">import</span> <span class="n">model_factory</span>
<span class="kn">from</span> <span class="nn">tlt.utils.types</span> <span class="kn">import</span> <span class="n">FrameworkType</span><span class="p">,</span> <span class="n">UseCaseType</span>

<span class="n">username</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;USER&#39;</span><span class="p">,</span> <span class="s1">&#39;user&#39;</span><span class="p">)</span>

<span class="c1"># Specify a writable directory for the dataset to be downloaded</span>
<span class="n">dataset_dir</span> <span class="o">=</span> <span class="s1">&#39;/tmp/data-</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">username</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">dataset_dir</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">dataset_dir</span><span class="p">)</span>

<span class="c1"># Specify a writeable directory for output (such as saved model files)</span>
<span class="n">output_dir</span> <span class="o">=</span> <span class="s1">&#39;/tmp/output-</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">username</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">output_dir</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">output_dir</span><span class="p">)</span>

<span class="c1"># Get the model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">model_factory</span><span class="o">.</span><span class="n">get_model</span><span class="p">(</span><span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;efficientnet_b0&quot;</span><span class="p">,</span> <span class="n">framework</span><span class="o">=</span><span class="n">FrameworkType</span><span class="o">.</span><span class="n">PYTORCH</span><span class="p">)</span>

<span class="c1"># Download and preprocess the RenderedSST2 dataset from the torchvision datasets catalog</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset_factory</span><span class="o">.</span><span class="n">get_dataset</span><span class="p">(</span><span class="n">dataset_dir</span><span class="o">=</span><span class="n">dataset_dir</span><span class="p">,</span>
                                      <span class="n">dataset_name</span><span class="o">=</span><span class="s1">&#39;RenderedSST2&#39;</span><span class="p">,</span>
                                      <span class="n">use_case</span><span class="o">=</span><span class="n">UseCaseType</span><span class="o">.</span><span class="n">IMAGE_CLASSIFICATION</span><span class="p">,</span>
                                      <span class="n">framework</span><span class="o">=</span><span class="n">FrameworkType</span><span class="o">.</span><span class="n">PYTORCH</span><span class="p">,</span>
                                      <span class="n">dataset_catalog</span><span class="o">=</span><span class="s1">&#39;torchvision&#39;</span><span class="p">)</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">preprocess</span><span class="p">(</span><span class="n">image_size</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">image_size</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">shuffle_split</span><span class="p">(</span><span class="n">train_pct</span><span class="o">=</span><span class="mf">.75</span><span class="p">,</span> <span class="n">val_pct</span><span class="o">=</span><span class="mf">.25</span><span class="p">)</span>

<span class="c1"># Train the model using the dataset</span>
<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ipex_optimize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Visualize the trained model result</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">get_batch</span><span class="p">()</span>

<span class="c1"># Predict with a single batch</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>

<span class="c1"># Map the predicted ids to the class names</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="p">[</span><span class="n">dataset</span><span class="o">.</span><span class="n">class_names</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">predictions</span><span class="p">]</span>

<span class="c1"># Display the results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">30</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">inp</span> <span class="o">=</span> <span class="n">images</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
    <span class="n">inp</span> <span class="o">=</span> <span class="n">inp</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.485</span><span class="p">,</span> <span class="mf">0.456</span><span class="p">,</span> <span class="mf">0.406</span><span class="p">])</span>
    <span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.229</span><span class="p">,</span> <span class="mf">0.224</span><span class="p">,</span> <span class="mf">0.225</span><span class="p">])</span>
    <span class="n">inp</span> <span class="o">=</span> <span class="n">std</span> <span class="o">*</span> <span class="n">inp</span> <span class="o">+</span> <span class="n">mean</span>
    <span class="n">inp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>
    <span class="n">correct_prediction</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">==</span> <span class="n">predictions</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
    <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;darkgreen&quot;</span> <span class="k">if</span> <span class="n">correct_prediction</span> <span class="k">else</span> <span class="s2">&quot;crimson&quot;</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">predictions</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">title</span><span class="p">()</span> <span class="k">if</span> <span class="n">correct_prediction</span> <span class="k">else</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="se">\n</span><span class="s2">(</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">labels</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Model predictions&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Correct predictions are shown in green&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Incorrect predictions are shown in red with the actual label in parenthesis&quot;</span><span class="p">)</span>

<span class="c1"># Export the model</span>
<span class="n">saved_model_dir</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">output_dir</span><span class="o">=</span><span class="n">output_dir</span><span class="p">)</span>

<span class="c1"># Quantize the trained model</span>
<span class="n">quantization_output</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="s2">&quot;quantized_model&quot;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">quantize</span><span class="p">(</span><span class="n">quantization_output</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">overwrite_model</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Benchmark the trained model using the Intel Neural Compressor config file</span>
<span class="n">model</span><span class="o">.</span><span class="n">benchmark</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">saved_model_dir</span><span class="o">=</span><span class="n">quantization_output</span><span class="p">)</span>
</pre></div>
</div>
<p>For more information on the API, see the <a class="reference internal" href="#/api.md"><span class="xref myst">API Documentation</span></a>.</p>
</section>
</section>
<section id="summary-and-next-steps">
<h2>Summary and Next Steps<a class="headerlink" href="#summary-and-next-steps" title="Link to this heading">¶</a></h2>
<p>The Intel Transfer Learning Tool can be used to develop an AI model and export
an Intel-optimized saved model for deployment. The sample CLI and API commands
we’ve presented show how to execute end-to-end transfer learning workflows.</p>
<p>For the no-code CLI, you can follow a
complete example that includes training, evaluation, benchmarking, and quantization
in the datasets, as well as some additional models in the <a class="reference internal" href="#examples/cli/README.md"><span class="xref myst">Beyond Get Started
CLI example</span></a> documentation. You can also read about all the
CLI commands in the <a class="reference internal" href="#/cli.md"><span class="xref myst">CLI reference</span></a>.</p>
<p>For the low-code API, read about the API in the <a class="reference internal" href="#/api.md"><span class="xref myst">API Documentation</span></a>.</p>
<p>Find more CLI and API examples in our list of <a class="reference internal" href="#examples/README.md"><span class="xref myst">Examples</span></a>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Intel® Transfer Learning Tool" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="examples/examples.html" class="btn btn-neutral float-right" title="Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022-2024, Intel Corporation.
      <span class="lastupdated">Last updated on Apr 10, 2024.
      </span></p>
  </div>

  
*Other names and brands may be claimed as the property of others.
<a href="http://www.intel.com/content/www/us/en/legal/trademarks.html">Trademarks</a>


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>