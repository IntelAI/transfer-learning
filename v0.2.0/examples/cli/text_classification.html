<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Text Classification TLT CLI Examples &mdash; Intel® Transfer Learning Tool 0.2.0 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="API Reference" href="../../api.html" />
    <link rel="prev" title="Image Classification TLT CLI Examples" href="image_classification.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Intel® Transfer Learning Tool
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Intel® Transfer Learning Tool Quick Start</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../cli.html">CLI Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../cli.html#tlt">tlt</a></li>
<li class="toctree-l2"><a class="reference internal" href="image_classification.html">Image Classification TLT CLI Examples</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Text Classification TLT CLI Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fine-tuning-using-your-own-dataset">Fine tuning using your own dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fine-tuning-using-a-dataset-from-the-tfds-catalog">Fine tuning using a dataset from the TFDS catalog</a></li>
<li class="toctree-l3"><a class="reference internal" href="#citations">Citations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks.html">Example Notebooks</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Intel® Transfer Learning Tool</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../../cli.html">CLI Reference</a></li>
      <li class="breadcrumb-item active">Text Classification TLT CLI Examples</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/examples/cli/text_classification.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="text-classification-tlt-cli-examples">
<h1>Text Classification TLT CLI Examples<a class="headerlink" href="#text-classification-tlt-cli-examples" title="Permalink to this heading">¶</a></h1>
<section id="fine-tuning-using-your-own-dataset">
<h2>Fine tuning using your own dataset<a class="headerlink" href="#fine-tuning-using-your-own-dataset" title="Permalink to this heading">¶</a></h2>
<p>The example below shows how to fine tune a TensorFlow text classification model using your own
dataset in the .csv format. The .csv file is expected to have 2 columns: a numerical class label
and the text/sentence to classify. Note that although the TLT API is more flexible and allows for
providing map functions to translate string class names to numerical values and filtering which
columns are being used, the CLI only allows using .csv files in the expected format.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">--dataset-dir</span></code> argument is the path to the directory where your dataset is located, and the
<code class="docutils literal notranslate"><span class="pre">--dataset-file</span></code> is the name of the .csv file to load from that directory. Use the <code class="docutils literal notranslate"><span class="pre">--class-names</span></code>
argument to specify a list of the classes and the <code class="docutils literal notranslate"><span class="pre">--delimiter</span></code> to specify the character that
separates the two columns. If no <code class="docutils literal notranslate"><span class="pre">--delimiter</span></code> is specified, the CLI will default to use a comma (<code class="docutils literal notranslate"><span class="pre">,</span></code>).</p>
<p>This example is downloading the <a class="reference external" href="https://archive-beta.ics.uci.edu/ml/datasets/sms+spam+collection">SMS Spam Collection</a>
dataset, which has a tab separated value file in the .zip file. This dataset has labeled SMS text
messages that are either being classified as <code class="docutils literal notranslate"><span class="pre">ham</span></code> or <code class="docutils literal notranslate"><span class="pre">spam</span></code>. The first column in the data file has
the label (<code class="docutils literal notranslate"><span class="pre">ham</span></code> or <code class="docutils literal notranslate"><span class="pre">spam</span></code>) and the second column is the text of the SMS mesage. The string class
labels are replaced with numerical values before training.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create dataset and output directories</span>
<span class="nv">DATASET_DIR</span><span class="o">=</span>/tmp/data
<span class="nv">OUTPUT_DIR</span><span class="o">=</span>/tmp/output
mkdir -p <span class="si">${</span><span class="nv">DATASET_DIR</span><span class="si">}</span>
mkdir -p <span class="si">${</span><span class="nv">OUTPUT_DIR</span><span class="si">}</span>

<span class="c1"># Download and extract the dataset</span>
wget -P <span class="si">${</span><span class="nv">DATASET_DIR</span><span class="si">}</span> https://archive.ics.uci.edu/ml/machine-learning-databases/00228/smsspamcollection.zip
unzip <span class="si">${</span><span class="nv">DATASET_DIR</span><span class="si">}</span>/smsspamcollection.zip

<span class="c1"># Make a copy of the .csv file with &#39;numerical&#39; in the file name</span>
<span class="nv">DATASET_FILE</span><span class="o">=</span>SMSSpamCollection_numerical.csv
cp <span class="si">${</span><span class="nv">DATASET_DIR</span><span class="si">}</span>/SMSSpamCollection <span class="si">${</span><span class="nv">DATASET_DIR</span><span class="si">}</span>/<span class="si">${</span><span class="nv">DATASET_FILE</span><span class="si">}</span>

<span class="c1"># Replace string class labels with numerical values in the .csv file\</span>
<span class="c1"># The list numerical class labels passed as the --class-names during training and evaluation</span>
sed -i <span class="s1">&#39;s/ham/0/g&#39;</span> <span class="si">${</span><span class="nv">DATASET_DIR</span><span class="si">}</span>/<span class="si">${</span><span class="nv">DATASET_FILE</span><span class="si">}</span>
sed -i <span class="s1">&#39;s/spam/1/g&#39;</span> <span class="si">${</span><span class="nv">DATASET_DIR</span><span class="si">}</span>/<span class="si">${</span><span class="nv">DATASET_FILE</span><span class="si">}</span>

<span class="c1"># Train small_bert/bert_en_uncased_L-2_H-128_A-2 using our dataset file which has tab delimiters</span>
tlt train <span class="se">\</span>
    -f tensorflow <span class="se">\</span>
    --model-name small_bert/bert_en_uncased_L-2_H-128_A-2 <span class="se">\</span>
    --output-dir <span class="si">${</span><span class="nv">OUTPUT_DIR</span><span class="si">}</span> <span class="se">\</span>
    --dataset-dir <span class="si">${</span><span class="nv">DATASET_DIR</span><span class="si">}</span> <span class="se">\</span>
    --dataset-file <span class="si">${</span><span class="nv">DATASET_FILE</span><span class="si">}</span> <span class="se">\</span>
    --epochs <span class="m">2</span> <span class="se">\</span>
    --class-names <span class="m">0</span>,1 <span class="se">\</span>
    --delimiter <span class="s1">$&#39;\t&#39;</span>

<span class="c1"># Evaluate the model exported after training</span>
<span class="c1"># Note that your --model-dir path may vary, since each training run creates a new directory</span>
tlt <span class="nb">eval</span> <span class="se">\</span>
    --model-dir <span class="si">${</span><span class="nv">OUTPUT_DIR</span><span class="si">}</span>/small_bert/bert_en_uncased_L-2_H-128_A-2/1 <span class="se">\</span>
    --model-name small_bert/bert_en_uncased_L-2_H-128_A-2 <span class="se">\</span>
    --dataset-dir <span class="si">${</span><span class="nv">DATASET_DIR</span><span class="si">}</span> <span class="se">\</span>
    --dataset-file <span class="si">${</span><span class="nv">DATASET_FILE</span><span class="si">}</span> <span class="se">\</span>
    --class-names <span class="m">0</span>,1 <span class="se">\</span>
    --delimiter <span class="s1">$&#39;\t&#39;</span>
</pre></div>
</div>
</section>
<section id="fine-tuning-using-a-dataset-from-the-tfds-catalog">
<h2>Fine tuning using a dataset from the TFDS catalog<a class="headerlink" href="#fine-tuning-using-a-dataset-from-the-tfds-catalog" title="Permalink to this heading">¶</a></h2>
<p>This example demonstrates using the TLT CLI to fine tune a text classification model using a
dataset from the <a class="reference external" href="https://www.tensorflow.org/datasets/catalog/overview">TensorFlow Datasets (TFDS) catalog</a>.
TLT supports the following text classification datasets from TFDS:
<a class="reference external" href="https://www.tensorflow.org/datasets/catalog/imdb_reviews">imdb_reviews</a>,
<a class="reference external" href="https://www.tensorflow.org/datasets/catalog/imdb_reviews">glue/sst2</a>,
and <a class="reference external" href="https://www.tensorflow.org/datasets/catalog/glue#gluecola_default_config">glue/cola</a>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create dataset and output directories</span>
<span class="nv">DATASET_DIR</span><span class="o">=</span>/tmp/data
<span class="nv">OUTPUT_DIR</span><span class="o">=</span>/tmp/output
mkdir -p <span class="si">${</span><span class="nv">DATASET_DIR</span><span class="si">}</span>
mkdir -p <span class="si">${</span><span class="nv">OUTPUT_DIR</span><span class="si">}</span>

<span class="c1"># Name of the dataset to use</span>
<span class="nv">DATASET_NAME</span><span class="o">=</span>imdb_reviews

<span class="c1"># Train small_bert/bert_en_uncased_L-2_H-128_A-2 using the TFDS dataset</span>
tlt train <span class="se">\</span>
    -f tensorflow <span class="se">\</span>
    --model-name small_bert/bert_en_uncased_L-2_H-128_A-2 <span class="se">\</span>
    --output-dir <span class="si">${</span><span class="nv">OUTPUT_DIR</span><span class="si">}</span> <span class="se">\</span>
    --dataset-dir <span class="si">${</span><span class="nv">DATASET_DIR</span><span class="si">}</span> <span class="se">\</span>
    --dataset-name <span class="si">${</span><span class="nv">DATASET_NAME</span><span class="si">}</span> <span class="se">\</span>
    --epochs <span class="m">2</span>

<span class="c1"># Evaluate the model exported after training</span>
<span class="c1"># Note that your --model-dir path may vary, since each training run creates a new directory</span>
tlt <span class="nb">eval</span> <span class="se">\</span>
    --model-dir <span class="si">${</span><span class="nv">OUTPUT_DIR</span><span class="si">}</span>/small_bert/bert_en_uncased_L-2_H-128_A-2/1 <span class="se">\</span>
    --model-name small_bert/bert_en_uncased_L-2_H-128_A-2 <span class="se">\</span>
    --dataset-dir <span class="si">${</span><span class="nv">DATASET_DIR</span><span class="si">}</span> <span class="se">\</span>
    --dataset-name <span class="si">${</span><span class="nv">DATASET_NAME</span><span class="si">}</span>
</pre></div>
</div>
</section>
<section id="citations">
<h2>Citations<a class="headerlink" href="#citations" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@InProceedings</span><span class="p">{</span><span class="n">maas</span><span class="o">-</span><span class="n">EtAl</span><span class="p">:</span><span class="mi">2011</span><span class="p">:</span><span class="n">ACL</span><span class="o">-</span><span class="n">HLT2011</span><span class="p">,</span>
  <span class="n">author</span>    <span class="o">=</span> <span class="p">{</span><span class="n">Maas</span><span class="p">,</span> <span class="n">Andrew</span> <span class="n">L</span><span class="o">.</span>  <span class="ow">and</span>  <span class="n">Daly</span><span class="p">,</span> <span class="n">Raymond</span> <span class="n">E</span><span class="o">.</span>  <span class="ow">and</span>  <span class="n">Pham</span><span class="p">,</span> <span class="n">Peter</span> <span class="n">T</span><span class="o">.</span>  <span class="ow">and</span>  <span class="n">Huang</span><span class="p">,</span> <span class="n">Dan</span>  <span class="ow">and</span>  <span class="n">Ng</span><span class="p">,</span> <span class="n">Andrew</span> <span class="n">Y</span><span class="o">.</span>  <span class="ow">and</span>  <span class="n">Potts</span><span class="p">,</span> <span class="n">Christopher</span><span class="p">},</span>
  <span class="n">title</span>     <span class="o">=</span> <span class="p">{</span><span class="n">Learning</span> <span class="n">Word</span> <span class="n">Vectors</span> <span class="k">for</span> <span class="n">Sentiment</span> <span class="n">Analysis</span><span class="p">},</span>
  <span class="n">booktitle</span> <span class="o">=</span> <span class="p">{</span><span class="n">Proceedings</span> <span class="n">of</span> <span class="n">the</span> <span class="mi">49</span><span class="n">th</span> <span class="n">Annual</span> <span class="n">Meeting</span> <span class="n">of</span> <span class="n">the</span> <span class="n">Association</span> <span class="k">for</span> <span class="n">Computational</span> <span class="n">Linguistics</span><span class="p">:</span> <span class="n">Human</span> <span class="n">Language</span> <span class="n">Technologies</span><span class="p">},</span>
  <span class="n">month</span>     <span class="o">=</span> <span class="p">{</span><span class="n">June</span><span class="p">},</span>
  <span class="n">year</span>      <span class="o">=</span> <span class="p">{</span><span class="mi">2011</span><span class="p">},</span>
  <span class="n">address</span>   <span class="o">=</span> <span class="p">{</span><span class="n">Portland</span><span class="p">,</span> <span class="n">Oregon</span><span class="p">,</span> <span class="n">USA</span><span class="p">},</span>
  <span class="n">publisher</span> <span class="o">=</span> <span class="p">{</span><span class="n">Association</span> <span class="k">for</span> <span class="n">Computational</span> <span class="n">Linguistics</span><span class="p">},</span>
  <span class="n">pages</span>     <span class="o">=</span> <span class="p">{</span><span class="mi">142</span><span class="o">--</span><span class="mi">150</span><span class="p">},</span>
  <span class="n">url</span>       <span class="o">=</span> <span class="p">{</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">aclweb</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">anthology</span><span class="o">/</span><span class="n">P11</span><span class="o">-</span><span class="mi">1015</span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@inproceedings</span><span class="p">{</span><span class="n">wang2019glue</span><span class="p">,</span>
  <span class="n">title</span><span class="o">=</span><span class="p">{{</span><span class="n">GLUE</span><span class="p">}:</span> <span class="n">A</span> <span class="n">Multi</span><span class="o">-</span><span class="n">Task</span> <span class="n">Benchmark</span> <span class="ow">and</span> <span class="n">Analysis</span> <span class="n">Platform</span> <span class="k">for</span> <span class="n">Natural</span> <span class="n">Language</span> <span class="n">Understanding</span><span class="p">},</span>
  <span class="n">author</span><span class="o">=</span><span class="p">{</span><span class="n">Wang</span><span class="p">,</span> <span class="n">Alex</span> <span class="ow">and</span> <span class="n">Singh</span><span class="p">,</span> <span class="n">Amanpreet</span> <span class="ow">and</span> <span class="n">Michael</span><span class="p">,</span> <span class="n">Julian</span> <span class="ow">and</span> <span class="n">Hill</span><span class="p">,</span> <span class="n">Felix</span> <span class="ow">and</span> <span class="n">Levy</span><span class="p">,</span> <span class="n">Omer</span> <span class="ow">and</span> <span class="n">Bowman</span><span class="p">,</span> <span class="n">Samuel</span> <span class="n">R</span><span class="o">.</span><span class="p">},</span>
  <span class="n">note</span><span class="o">=</span><span class="p">{</span><span class="n">In</span> <span class="n">the</span> <span class="n">Proceedings</span> <span class="n">of</span> <span class="n">ICLR</span><span class="o">.</span><span class="p">},</span>
  <span class="n">year</span><span class="o">=</span><span class="p">{</span><span class="mi">2019</span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@misc</span><span class="p">{</span><span class="n">misc_sms_spam_collection_228</span><span class="p">,</span>
  <span class="n">author</span>       <span class="o">=</span> <span class="p">{</span><span class="n">Almeida</span><span class="p">,</span> <span class="n">Tiago</span><span class="p">},</span>
  <span class="n">title</span>        <span class="o">=</span> <span class="p">{{</span><span class="n">SMS</span> <span class="n">Spam</span> <span class="n">Collection</span><span class="p">}},</span>
  <span class="n">year</span>         <span class="o">=</span> <span class="p">{</span><span class="mi">2012</span><span class="p">},</span>
  <span class="n">howpublished</span> <span class="o">=</span> <span class="p">{</span><span class="n">UCI</span> <span class="n">Machine</span> <span class="n">Learning</span> <span class="n">Repository</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="image_classification.html" class="btn btn-neutral float-left" title="Image Classification TLT CLI Examples" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../api.html" class="btn btn-neutral float-right" title="API Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Intel.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>